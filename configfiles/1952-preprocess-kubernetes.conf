# SOF-ELK® Configuration File
# (C)2023 Lewes Technology Consulting, LLC
#
# This file parses datestamp+KV-formatted Kubernetes logs

filter {
  if [type] == "kubernetes" {

      grok { 
        match => [ "message", "^%{NOTSPACE:raw_timestamp}%{SPACE}%{GREEDYDATA:message_remainder}" ] 
      }

      mutate { 
        replace => { "message" => "%{message_remainder}" } 
      }

      mutate { 
        remove_field => [ "message_remainder" ] 
      }

      date { 
        match => [ "raw_timestamp”, “ISO8601" ] 
      }

  }
}
