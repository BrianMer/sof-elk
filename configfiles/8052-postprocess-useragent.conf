# SOF-ELKÂ® Configuration File
# (C)2023 Lewes Technology Consulting, LLC
#
# This file enriches a useragent field

filter {
  # enrich the useragent field
  if [useragent] {
    if [useragent] == "" {
      mutate {
        replace => { "useragent" => "-" }
      }

    } else {
      mutate {
        # remove quotes from quoted string
        # convert + sign to space
        gsub => [
          "useragent", "\"", "",
          "useragent", "\+", " "
        ]
      }
      useragent {
        source => [useragent]
        target => [useragentinfo]
      }
    }
  }
}